function checkMelliJob(n,t){n==!1&&t.length>0&&alert("کد ملی معتبر نمی باشد")}function checkMelliCode(t){var i;return i=t,i.length==10?i=="1111111111"||i=="0000000000"||i=="2222222222"||i=="3333333333"||i=="4444444444"||i=="5555555555"||i=="6666666666"||i=="7777777777"||i=="9999999999"?!1:(c=parseInt(i.charAt(9)),n=parseInt(i.charAt(0))*10+parseInt(i.charAt(1))*9+parseInt(i.charAt(2))*8+parseInt(i.charAt(3))*7+parseInt(i.charAt(4))*6+parseInt(i.charAt(5))*5+parseInt(i.charAt(6))*4+parseInt(i.charAt(7))*3+parseInt(i.charAt(8))*2,r=n-parseInt(n/11)*11,r==0&&r==c||r==1&&c==1||r>1&&c==11-r?!0:!1):!1}function ToggleShowPass(){var t=document.getElementById("txtPassword"),n=document.getElementById("txtConfirmPassword");t.type==="password"?(t.type="text",n!=null&&(n.type="text"),$("#imgShowPass").prop("src","../images/showpass.png"),$("#imgShowPass").prop("title","پنهان کردن رمز عبور")):(t.type="password",n!=null&&(n.type="password"),$("#imgShowPass").prop("src","../images/showpassOff.png"),$("#imgShowPass").prop("title","نمایش رمز عبور"))}function getParameterByName(n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+n+"=([^&#]*)"),t=i.exec(location.search);return t===null?"":decodeURIComponent(t[1].replace(/\+/g," "))}function just_persian(n){return/^[\u0600-\u06FF\s]+$/.test(n)?!0:!1}function just_english(n){return/^[A-Za-z0-9]$/i.test(n)?!0:!1}function just_englishComplex(n){return!/^[A-Za-z0-9]$/i.test(n)&&!/([.,!,%,&,@,#,$,^,*,?,_,~,(,),+,=,_,/])/i.test(n)?!1:!0}function validateEmail(n){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(n)}function emailIsValid(n){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)}function validate(){var n=$("#result"),t=$("#email").val();return n.text(""),validateEmail(t)?(n.text(t+" is valid :)"),n.css("color","green")):(n.text(t+" is not valid :("),n.css("color","red")),!1}function validatePhone(){return phoneerror=$(".phone").val()==""?"Please enter phone number":$(".phone").val().length!==10?"Must be 10 Digits":$.isNumeric($(".phone").val())||$(".phone").val()==""?"":"this field cannot contain letters",console.log(phoneerror),phoneerror}function OnClientClick(){var h=getParameterByName("EditAccount"),r,n,i;if(h!=""&&(EditMode=!0),$("#LMessage").text(""),!$("input[id=ChAccept]").prop("checked")){$("#LMessage").css("color","red");$("#LMessage").text("کاربر گرامی ، لطفا صحت اطلاعات را تایید نمایید ، تا اعمال تغییرات انجام شود");return}if(r=$("#txt_Username").val(),Config.CheckUserNameASMelliCode){if(tmpres=checkMelliCode($("#txt_Username").val()),!tmpres){$("#LMessage").text("نام کاربری یا کد ملی صحیح نمی باشد");return}}else{if(n=$("#txt_NCode").val(),GetScope().LegalPerson&&(n=$("#txt_CEONationalCode").val()),n.length<10){$("#LMessage").text("کد ملی باید ۱۰ رقمی باشد");return}if(tmpres=checkMelliCode(n),!tmpres){$("#LMessage").text("کد ملی صحیح نمی باشد");return}}if(r==""){$("#LMessage").css("color","red");$("#LMessage").text("نام کاربری را وارد نمایید");return}if(EditMode!=!0){if($("#txtPassword").val()==""){$("#LMessage").css("color","red");$("#LMessage").text("رمز عبور را وارد نمایید");return}if($("#txt_ConfirmPass").val()==""){$("#LMessage").css("color","red");$("#LMessage").text("تکرار رمز عبور را وارد نمایید");return}if($("#txtPassword").val().length<5){$("#LMessage").text("رمز عبور باید حداقل ۵ کاراکتر باشد");return}if($("#txt_ConfirmPass").val()!=$("#txtPassword").val()){$("#LMessage").css("color","red");$("#LMessage").text("رمز عبور و تکرار آن باید شبیه هم باشند");return}if(Config.PassWordComplex==!0&&PasswordComplexValid==!1){$("#LMessage").css("color","red");$("#LMessage").text("رمز عبور باید شامل حروف و اعداد و کلمات پیچیده باشد");return}}var l=$(".rtsSelected").attr("id"),u=$("#txt_owername").val().trim(),f=$("#txt_OwnerFamilyName").val().trim(),e=$("#txt_OwnerTell").val().trim(),c=$("#txtEmail").val().trim(),o=$("#txt_OwnerFatherName").val().trim(),s=$("#txt_RegIDNoHaghighi").val().trim(),t=$("#txt_OwenrBirthDate").val().trim();if(GetScope().LegalPerson){if(tmpEumAccountType=2,u=$("#txt_CEOName").val(),f=$("#txt_CEOFamily").val(),e=$("#txt_CEOCellNo").val(),c=$("#txt_CEOEmail").val(),o=$("#txt_CEOFatherName").val(),s=$("#txt_CEOIDNo").val(),t=$("#txt_CEOBirhDate").val().trim(),$("#txt_companyname").val()==""){$("#LMessage").css("color","red");$("#LMessage").text("نام شرکت را وارد نمایید");return}}else tmpEumAccountType=1;if(u==""){$("#LMessage").css("color","red");$("#LMessage").text("نام کاربر را وارد نمایید");return}if(f.trim()==""){$("#LMessage").css("color","red");$("#LMessage").text("نام خانوادگی را وارد نمایید");return}if(o.trim()==""){$("#LMessage").css("color","red");$("#LMessage").text("نام پدر را وارد نمایید");return}if(s.trim()==""){$("#LMessage").css("color","red");$("#LMessage").text("شماره شناسنامه را وارد نمایید");return}if(!MelliCodeIsValid&&!EditMode){$("#LMessage").text("کد ملی صحیح نیست");$("#LMessage").css("color","red");return}if(t.match(/\//g)==null||t.match(/\//g).length!=2||t.length!=10){$("#LMessage").text("تاریخ تولد را کامل وارد نمایید");return}if(GetScope().Account_Info.OwnerDegree==undefined&&GetScope().Account_Info.CEOCI_Degree==undefined){$("#LMessage").css("color","red");$("#LMessage").text("تحصیلات را وارد نمایید");return}if($("#txt_postcode").val().length<10){$("#LMessage").text("کد پستی باید ۱۰ رقمی باشد");return}if(GetScope().Account_Info.Address==""||GetScope().Account_Info.Address==undefined){$("#LMessage").css("color","red");$("#LMessage").text("آدرس را وارد نمایید");return}if(i=e,i==undefined||i==""){$("#LMessage").css("color","red");$("#LMessage").text("شماره همراه را وارد نمایید");return}if(!shahkar_IsValid&&!EditMode){$("#LMessage").text("کد ملی با شماره همراه همخوانی ندارد");$("#LMessage").css("color","red");return}if(!Mobile_IsValid&&!EditMode){$("#LMessage").text("اعتبار سنجی شماره همراه انجام نشده است");$("#LMessage").css("color","red");return}if($("#RadCaptcha1_CaptchaTextBox").val()==""){$("#LMessage").css("color","red");$("#LMessage").text("کد امنیتی را وارد نمایید");return}if(!EditMode&&$("#DivSmsConfirm").length>0&&$("#DivSmsConfirm").is(":visible")&&!ConfirmCodeIsTrue){$("#LMessage").text("کد تاییدیه را به صورت صحیح وارد نمایید");$("#LMessage").css("color","red");return}if(imageDataBase64==null&&Config.ShowUploadButton&&!EditMode){$("#LMessage").text("تصویر کارت ملی را بارگذاری نمایید");return}StartBusy("MainDIv","در حال ذخیره اطلاعات");Savefn()}function RequestToken(){$request=$.ajax({type:"POST",url:"CreateAccount.aspx/RequestToken",crossDomin:!0,contentType:"application/json; charset=utf-8",dataType:"json",processdata:!0,success:function(n){TrustToken=n},error:function(){}})}function generateUUID(){var n=(new Date).getTime(),t=performance&&performance.now&&performance.now()*1e3||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var r=Math.random()*16;return n>0?(r=(n+r)%16|0,n=Math.floor(n/16)):(r=(t+r)%16|0,t=Math.floor(t/16)),(i==="x"?r:r&3|8).toString(16)})}function CurrentShamsiDateString(){var n=(new persianDate).format(),t=n.toEnglishDigits(),i=t.replaceAll("-","/");return i.split(" ")}function Savefn(){var n=CurrentShamsiDateString(),i,t,r;n&&(n[0]?n[0]=n[0].replace("-","/"):"");i=EditAccount?GetScope().Account_Info.NidAccount:"00000000-0000-0000-0000-000000000000";EditAccount?(t={pAccount:GetScope().Account_Info},delete t.pAccount.__type):t={pAccount:{NidAccount:i.toLowerCase(),Address:$("#txt_address").val(),Fax:$("#txt_Fax").val(),AccountPassword:$("#txtPassword").val(),EumAccountType:tmpEumAccountType,CEOCellNo:$("#txt_CEOCellNo").val(),CEOCI_Degree:GetScope().Account_Info.CEOCI_Degree,CEOEmail:$("#txt_CEOEmail").val(),CEOFamily:$("#txt_CEOFamily").val(),CEOFatherName:$("#txt_CEOFatherName").val(),CEOIDNo:$("#txt_CEOIDNo").val(),CEOName:$("#txt_CEOName").val(),CEOPhoneNo:$("#txt_CEOPhoneNo").val(),CEOSex:ipsex,CEOBirthDate:$("#txt_CEOBirhDate").val(),CEONationalCode:$("#txt_CEONationalCode").val(),Codes:$("#txt_Codes").val(),CompanyName:$("#txt_companyname").val(),EumAccessType:tmpEumAccessType,MailBox:tmpEumAccountType==1?$("#txtEmail").val():$("#txt_mailbox").val(),PostCode:$("#txt_postcode").val(),RegNo:$("#txt_RegNo").val(),RequestNationalCode:$("#txt_RequestNationalCode").val(),Telephone:$("#txt_Tell").val(),AccountName:$("#txt_Username").val(),Vilage:$("#txt_vilage").val(),OwnerBirthDate:$("#txt_OwenrBirthDate").val(),OwnerDegree:GetScope().Account_Info.OwnerDegree,OwnerLastName:$("#txt_OwnerFamilyName").val(),OwnerFirstName:$("#txt_owername").val(),OwnerTell:$("#txt_OwnerTell").val(),OwnerSex:psex,OwnerNationalCode:Config.CheckUserNameASMelliCode?$("#txt_Username").val():$("#txt_NCode").val(),ImageUrlVirtualPath:imageDataBase64,OwnerFatherName:$("#txt_OwnerFatherName").val(),OwnerIDNO:$("#txt_RegIDNoHaghighi").val(),StrDate:n[0],StrTime:n[1]}};EditMode&&(t.pAccount.Image=null);r=JSON.stringify(t);$request=$.ajax({type:"POST",url:"CreateAccount.aspx/CreateNewAccount",data:r,crossDomin:!0,contentType:"application/json; charset=utf-8",dataType:"json",processdata:!0,success:function(n){if(n=n.d,StopBusy("MainDIv"),n==null?alert("خطای دسترسی"):n!=null&&n.error!=null&&alert(n.error),n!=null)if(n.ErrorResult.BizErrors.length>0){var i=n.ErrorResult.BizErrors[0].ErrorTitel;n.ErrorResult.BizErrors[0].ErrorKey=="DuplicateUser"?$("#LMessage").html("شهروند گرامی; این کد ملی قبلا در سامانه ثبت عضویت شده است. در صورت فراموش کردن رمزعبور از کلید بازآوری رمز عبور استفاده کنید"):$("#LMessage").html(i);RequestToken()}else EditAccount?$("#msgSuccess").html("ویرایش اطلاعات با موفقیت انجام شد"):$("#LMessage").html("ثبت عضویت با موفقیت انجام شد"),ExportToIsfahanApi(t.pAccount),$("#MainDIv").slideToggle(),$("#SecDIv").slideToggle()},error:function(){RequestToken();StopBusy("MainDIv");$("#LMessage").html("خطای دسترسی . لطفا دوباره صفحه را بازآوری نمایید");console.log("خطای دسترسی . لطفا دوباره صفحه را بازآوری نمایید")}})}function ExportToIsfahanApi(n){var t={Gender:n.OwnerSex,NationCode:n.OwnerNationalCode,FirstName:n.OwnerFirstName,LastName:n.OwnerLastName,Email:n.CEOEmail,FatherName:n.OwnerFatherName,MobileNumber:n.OwnerTell,BirthDate:n.OwnerBirthDate},i=JSON.stringify(t);$request=$.ajax({type:"POST",url:"https://profile.isfahan.ir/api/citizens/RegisterUser",data:i,crossDomin:!0,contentType:"application/json; charset=utf-8",dataType:"json",processdata:!0,success:function(){},error:function(){}})}function Accept(){var n=$("#ChAccept:checked");n.length>0&&Config.ValidateBySms&&Config.ValidateBySms==!0&&ConfirmCodeIsTrue==!0?$("#BtnSave").prop("disabled",!1):n.length>0&&Config.ValidateBySms==!1?$("#BtnSave").prop("disabled",!1):$("#BtnSave").attr("disabled","disabled")}function getRandomArbitrary(n,t){return Math.random()*(t-n)+n}function getRandomInt(n,t){return n=Math.ceil(n),t=Math.floor(t),Math.floor(Math.random()*(t-n+1))+n}function SendConfirmSMS(){var t=$("#txt_Username").val(),u=$(".rtsSelected").attr("id"),n=$("#txt_OwnerTell").val(),i,r;if(GetScope().LegalPerson&&(n=$("#txt_CEOCellNo").val()),n=n.replaceAll("-","").replaceAll("_",""),t==""){$("#LMessage").text("نام کاربری را وارد نمایید");$("#LMessage").css("color","red");return}if(n==undefined||n==""){$("#LMessage").text("شماره همراه را وارد نمایید");$("#LMessage").css("color","red");return}if(!Mobile_IsValid){$("#LMessage").text("اعتبار سنجی شماره همراه انجام نشده است");$("#LMessage").css("color","red");return}i={pBizCode:t,pNumber:n};r=JSON.stringify(i);$("#btnSend").prop("disabled",!0);StartBusy("DivSmsConfirm");$request=$.ajax({type:"POST",url:"CreateAccount.aspx/SendConfirmSMS",data:r,crossDomin:!0,contentType:"application/json; charset=utf-8",dataType:"json",processdata:!0,success:function(n){StopBusy("DivSmsConfirm");n.d==""?($("#LRecoveryError").text("خطا در ارسال کد"),$("#LRecoveryError").css("color","red")):($("#LRecoveryError").text("کد تاییدیه با موفقیت به شماره همراه شما ارسال شد"),$("#LRecoveryError").css("color","green"),$("#txtConfirmCode").show(),$("#txt_OwnerTell").prop("disabled",!0),GetScope().LegalPerson&&$("#txt_CEOCellNo").prop("disabled",!0),$("#txtConfirmCode").prop("disabled",!1),$("#btnSend").prop("disabled",!1),StartTimer())},error:function(){$("#btnSend").prop("disabled",!1);StopBusy("DivSmsConfirm");$("#LRecoveryError").text("خطا در ارسال کد");$("#LRecoveryError").css("color","red")}})}function ConfirmCode_keypress(){$("#txtConfirmCode").val().length==5&&CheckConfirmCode()}function CheckConfirmCode(){var n=$("#txtConfirmCode").val(),t=$("#txt_Username").val(),i={pBizCode:t,pConfirmCode:n},r=JSON.stringify(i);$("#LRecoveryError").text("");$("#imgError").hide();StartBusy("txtConfirmCode");$request=$.ajax({type:"POST",url:"CreateAccount.aspx/CheckConfirmCode",data:r,crossDomin:!0,contentType:"application/json; charset=utf-8",dataType:"json",processdata:!0,success:function(n){StopBusy("txtConfirmCode");$("#txtConfirmCode").prop("disabled",!0);n.d==!0?(ConfirmCodeIsTrue=!0,$("#txtConfirm").css("color","green"),$("#LRecoveryError").css("color","green"),$("#LRecoveryError").text("کد تاییدیه صحیح می باشد"),$("#imgTick").show(),$("#imgError").hide(),$("#btnSend").prop("disabled",!0),$("#ChAccept").is(":checked")&&$("#BtnSave").prop("disabled",!1)):($("#txtConfirm").css("color","red"),$("#LRecoveryError").css("color","red"),$("#LRecoveryError").text("کد تاییدیه معتبر نمی باشد"),$("#imgError").show(),$("#imgTick").hide(),$("#btnSend").prop("disabled",!1))},error:function(){StopBusy("txtConfirmCode")}})}function StartTimer(){var n=60,t;typeof Config.TimerTime!="undefined"&&(n=Config.TimerTime);$("#btnSend").attr("disabled",!0);$("#btnSend").css("opacity",.5);t="<p id='lblComment' style=\"font-size:small\">در صورت ارسال نشدن پیامک ، بعد از "+n+" ثانیه میتوانید دوباره دکمه دریافت کد تایید را بزنید<\/p > ";$("#lblComment").remove();$("#LRecoveryError").after(t);$("#lblComment").css("color","red");indexTime=n;Counter=setInterval(myFunction,1e3)}function encodeImageFileAsURL(n,t){var u=n.files[0],i,r;if(u.size>Config.UploadSize){alert("حجم فایل باید کمتر از "+Config.UploadSize/1024+" کیلو بایت باشد");return}if(i=u.name,i.split(".")[1].toLowerCase().indexOf("jpg")==-1&&i.split(".")[1].toLowerCase().indexOf("png")==-1&&i.split(".")[1].toLowerCase().indexOf("jpeg")==-1){alert("نوع فایل باید از نوع عکس باشد");return}r=new FileReader;r.onloadend=function(){var n=r.result,i;t?$("#ceoImage").attr("src",n):$("#ownerImage").attr("src",n);i=n.search("base64");imageDataBase64=n.substr(i+7,n.length)};r.readAsDataURL(u)}function getParameterByName(n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+n+"=([^&#]*)"),t=i.exec(location.search);return t===null?"":decodeURIComponent(t[1].replace(/\+/g," "))}function SetLeganPersion(n){GetScope().LegalPerson=n}function GetScope(){return angular.element(document.getElementById("myCtrlID")).scope()}function checkShenaseMelli(n){var r=n.length,i;if(r<11||parseInt(n,10)==0||parseInt(n.substr(3,6),10)==0)return!1;var u=parseInt(n.substr(10,1),10),f=parseInt(n.substr(9,1),10)+2,e=[29,27,23,19,17],t=0;for(i=0;i<10;i++)t+=(f+parseInt(n.substr(i,1),10))*e[i%5];return t=t%11,t==10&&(t=0),u==t}var UserData,tmpEumAccountType,tmpEumAccessType,ipsex,psex,ConfirmCodeIsTrue,SmsValidateState,tmpCode,imageDataBase64,EditAccount,app;$(document).ready(function(){function i(i){var r=$(i.currentTarget),u=r[0].id,f;if($("#NewError"+u).remove(),u=="txt_Username"){if(r.val()!=""&&t(i,r.val(),"",""),Config.CheckUserNameASMelliCode&&(tmpres=checkMelliCode($("#txt_Username").val()),!tmpres)){n(r,"نام کاربری یا کد ملی صحیح نمی باشد");return}}else if(r[0].id=="txt_NCode")if(Config.CheckValidMelliCode){if(f=$("#txt_NCode").val(),r.val().length==10&&t(i,"",r.val(),""),tmpVal=checkMelliCode(f),!tmpVal){n(r,"کد ملی صحیح نمی باشد");return}}else r.val().length==10&&t(i,"",r.val(),"");else(r[0].id=="txt_OwnerTell"||r[0].id=="txt_CEOCellNo")&&(r.val().length==11?r.val().startsWith("09")?t(i,"","",r.val()):n(r,"شماره همراه صحیح نیست"):n(r,"شماره همراه باید 11 رقم باشد"))}function n(n,t){var i=n[0].id;$("#NewError"+i).remove();n.after("<span class=\"info-panel\" style='color:red;margin-right:10px;font-size:small' id='NewError"+i+"'>"+t+"<\/span>")}function t(t,i,u,f){var e={pAccountName:i,pNationalCode:u,pMobileNo:f,NidAccount:GetScope().Account_Info.NidAccount!=undefined?GetScope().Account_Info.NidAccount:null},o=JSON.stringify(e);$("#LMessage").text("");StartBusy("txtConfirmCode","در حال چک کردن شماره موبایل");$request=$.ajax({type:"POST",url:"CreateAccount.aspx/MobileCheck",data:o,crossDomin:!0,contentType:"application/json; charset=utf-8",dataType:"json",processdata:!0,success:function(e){var o,s,h;StopBusy("txtConfirmCode");e!=null&&e.d!=null&&e.d.BizErrors.length>0?(o=$(t.currentTarget),e.d.BizErrors[0].ErrorKey=="DuplicateAccount"?n(o,"شهروند گرامی; این کد ملی قبلا در سامانه ثبت عضویت شده است. در صورت فراموش کردن رمزعبور از کلید بازآوری رمز عبور استفاده کنید"):e.d.BizErrors[0].ErrorKey=="DuplicateNationalCode"?n(o,"شهروند گرامی; این کد ملی قبلا در سامانه ثبت عضویت شده است. در صورت فراموش کردن رمزعبور از کلید بازآوری رمز عبور استفاده کنید"):n(o,e.d.BizErrors[0].ErrorTitel),$("#btnSend").prop("disabled",!0)):e==null||e.d==null?(Mobile_IsValid=!1,MelliCodeIsValid=!1):i!=""||u!=""?MelliCodeIsValid=!0:f!=""&&(Mobile_IsValid=!0,s=$("#txt_OwnerTell").val(),GetScope().LegalPerson&&(s=$("#txt_CEOCellNo").val()),h=$("#txt_Username").val(),$("#btnSend").prop("disabled",!1),Config.CheckShahkar?r(t,h,s):($("#btnSend").prop("disabled",!1),shahkar_IsValid=!0))},error:function(){}})}function r(t,i,r){var u={pNationalCode:i,pMobile:r},f=JSON.stringify(u);$("#btnSend").prop("disabled",!0);$("#LMessage").text("");StartBusy("txtConfirmCode","در حال چک کردن شماره موبایل");$request=$.ajax({type:"POST",url:AppConfig.Params.SecurityUrl+"CheckShahkar",data:f,crossDomin:!0,contentType:"application/json; charset=utf-8",dataType:"json",processdata:!0,success:function(i){if(StopBusy("txtConfirmCode"),i==!1){var r=$(t.currentTarget);n(r,"کد ملی با شماره همراه همخوانی ندارد");$("#btnSave").prop("disabled",!0);shahkar_IsValid=!1}else $("#btnSave").prop("disabled",!1),shahkar_IsValid=!0,$("#btnSend").prop("disabled",!1)},error:function(){}})}kamaDatepicker("txt_OwenrBirthDate",{buttonsColor:"red"});kamaDatepicker("txt_CEOBirhDate",{buttonsColor:"red"});Config.ValidateBySms&&Config.ValidateBySms==!0?$(".smsValidate").show():$(".smsValidate").hide();Config.CheckUserNameASMelliCode&&Config.CheckUserNameASMelliCode==!0?($("#txt_Username").addClass("number"),$("#txt_Username").prop("maxlength","10"),$("#divNationalCode").addClass("disabled"),$("#divNationalCode2").addClass("disabled")):$("#txt_Username").addClass("engtxt ");setTimeout(function(){try{$(".pdatePiker").persianDatepicker()}catch(n){}},300);$('input[type="textbox"]').keyup(function(n){n.keyCode==13&&$(this).next().focus()});$(".number").inputFilter(function(n){return/^\d*$/.test(n)});$(".phone").on("change keyup paste keydown",validate);$(".email").on("change",function(){var n=emailIsValid($(this).val());n==!1&&$(this).val("")});$(".persiantxt").on("keypress",function(n){event.keyCode>=1777&&event.keyCode<=1785||event.keyCode>=48&&event.keyCode<=57||n.charCode>=65&&n.charCode<=90||n.charCode>=97&&n.charCode<=122?(n.preventDefault(),$("#NewError").remove(),$(n.currentTarget).after("<span id='NewError'>لطفا حروف فارسی تایپ نمایید<\/span>")):$("#NewError").remove()});$(".persiantxtNum").on("keypress",function(n){event.keyCode>=1777&&event.keyCode<=1785||n.charCode>=65&&n.charCode<=90||n.charCode>=97&&n.charCode<=122?(n.preventDefault(),$("#NewError").remove(),$(n.currentTarget).after("<span id='NewError'>لطفا حروف فارسی تایپ نمایید<\/span>")):$("#NewError").remove()});$(".engtxt").on("input",function(n){var i=$(n.currentTarget).val(),t=i.substr(i.length-1);t!="Backspace"&&t!="Delete"&&t!=""&&(just_englishComplex(t)===!1?($(n.currentTarget).val(i.slice(0,-1)),n.preventDefault(),$("#NewError").remove(),$(n.currentTarget).after("<span id='NewError'>لطفا اعداد و حروف انگلیسی تایپ نمایید<\/span>")):$("#NewError").remove())});$(".engtxt").on("keypress",function(n){just_englishComplex(n.key)===!1?(n.preventDefault(),$("#NewError").remove(),$(n.currentTarget).after("<span id='NewError'>لطفا اعداد و حروف انگلیسی تایپ نمایید<\/span>")):$("#NewError").remove()});$(":file").filestyle({text:" انتخاب فایل",btnClass:"btn-success",placeholder:"فایل را انتخاب کنید",size:"sm"});$("#txt_OwnerTell,#txt_CEOCellNo").keyup(function(n){Mobile_IsValid=!1;var t=$(n.currentTarget);t.val().length==11&&i(n)});$("#txt_Username").keyup(function(){$("#NewErrortxt_Username").remove()});$("#txt_OwnerTell,#txt_Username,#txt_NCode,#txt_CEOCellNo").focusout(function(n){i(n)});$("#txtPassword").focusout(function(){if(Config.PassWordComplex==!0){if(PasswordComplexValid==!1){target=$("#Progress1");n(target,"رمز عبور باید شامل حروف و اعداد و کلمات پیچیده باشد");return}$("#NewErrorProgress1").hide()}});AppConfig.LoadObj(function(){})});UserData={};String.prototype.toEnglishDigits=function(){return this.replace(/[۰-۹]/g,function(n){return["۰","۱","۲","۳","۴","۵","۶","۷","۸","۹"].indexOf(n)})};String.prototype.replaceAll=function(n,t){var i=this;return i.split(n).join(t)},function(n){n.fn.inputFilter=function(t){return this.on("input keydown keyup mousedown mouseup select contextmenu drop",function(){t(this.value)?(this.oldValue=this.value,this.oldSelectionStart=this.selectionStart,this.oldSelectionEnd=this.selectionEnd,n("#NewError").remove()):this.hasOwnProperty("oldValue")&&(n("#NewError").remove(),n(this).after("<span id='NewError'>لطفا اعداد انگلیسی تایپ نمایید<\/span>"),this.value=this.oldValue,this.setSelectionRange(this.oldSelectionStart,this.oldSelectionEnd))})}}(jQuery);var EditMode=!1,shahkar_IsValid=!0,TrustToken="";tmpEumAccountType=1;tmpEumAccessType=1;ipsex=null;psex=null;var AccountInfo=null,Mobile_IsValid=!1,MelliCodeIsValid=!1;ConfirmCodeIsTrue=!1;SmsValidateState=!1;tmpCode=null;imageDataBase64=null;app=angular.module("myApp",[]);app.controller("myCtrl",["$scope","$http",function(n){n.name="";n.Account_Info={CEOCI_Degree:0,OwnerSex:"true"};n.LegalPerson=!1;n.ShowInquiryButton=Config.ShowInquiryButton;n.Degree=[{Id:0,Title:"متوسطه "},{Id:0,Title:"دیپلم"},{Id:2,Title:"کاردانی"},{Id:3,Title:"کارشناسی"},{Id:3,Title:"کارشناسی ارشد"},{Id:4,Title:"دکترا"},];n.ShowUploadButton=Config.ShowUploadButton;EditAccount=getParameterByName("EditAccount");EditAccount&&(n.FormTitle="ثبت عضویت کاربر جدید",$("#headertxt").html("ویرایش عضویت در سامانه شهروند سپاری"),StartBusy("myCtrlID","دریافت اطلاعات"),Config.ValidateBySms=!1,$(document).ready(function(){$("#lblfooterText").text(Config.FooterText)}),setTimeout(function(){SafaSecurity.GetAccountInfo(function(t){StopBusy("myCtrlID","دریافت اطلاعات");n.Account_Info=t.d;n.Account_Info==null?alert("اطلاعات کاربر یافت نشد"):(n.EditDisable=!0,$("#BtnSave").html("اعمال تغییرات"),n.Account_Info.EumAccountType==2&&($(".nav-tabs > li.active").removeClass("active"),$("#personTab").removeClass("active in"),$("#legalTab1").addClass("active"),$("#legalTab").addClass("active in"),n.LegalPerson=!0),n.Account_Info&&(n.Account_Info.OwnerSex=n.Account_Info.OwnerSex==!1?"false":"true",n.Account_Info.CEOSex=n.Account_Info.CEOSex==!1?"false":"true",n.$apply()),n.Account_Info.Image!=null?$("#ownerImage").attr("src","data:image/jpg;base64,"+btoa(n.Account_Info.Image)):$("#ownerImage").hide())})},1e3))}]);